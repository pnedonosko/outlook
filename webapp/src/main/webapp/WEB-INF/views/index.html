<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:with="lang=${#locale.language}" th:lang="${lang}">

<head>
  <meta charset="UTF-8">
  <title>Index</title>
  <link rel="stylesheet" type="text/css" href="/outlook/skin/fabric.min.css"/>
  <link rel="stylesheet" type="text/css" href="/outlook/skin/fabric.components.min.css"/>
  <link rel="stylesheet" type="text/css" href="/outlook/skin/outlook.css"/>
  <link rel="stylesheet" type="text/css" href="/outlook/skin/jquery-ui.min.css"/>
  <link rel="stylesheet" type="text/css" href="/outlook/skin/jquery-ui.structure.min.css"/>
  <link rel="stylesheet" type="text/css" href="/outlook/skin/jquery-ui.theme.min.css"/>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="/outlook/js/jquery-ui.js"></script>
  <script src="/outlook/js/jquery.fabric.min.js"></script>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js"></script>

  <script src="/outlook/js/outlook-logout.js"></script>
  <script src="/outlook/js/outlook.bundle.js"></script>

  <script th:inline="javascript">
    eXo = {};
    eXo.env = {};
    eXo.env.portal = {};
    eXo.env.app = {};
    eXo.env.app.rest = {};

    // base name
    eXo.env.portal.context = [[${baseName}]];
    eXo.env.app.context = eXo.env.portal.context;

    // portal rest
    eXo.env.portal.rest = [[${currentRestContextName}]];

    // language
    eXo.env.portal.language = [[${language}]];

    // getting a language of the user
    const lang = eXo && eXo.env && eXo.env.portal && eXo.env.portal.language || "en";

    // outlook
    eXo.env.app.outlook = [[${outlook}]];

    // outlook spring
    eXo.env.app.spring = [[${spring}]];

    /*
    // example of getting  Outlook Resource Bundle url (use GET request in order to get JSON resource)
    const resourceBundleName = "locale.outlook.Outlook";
    const url = eXo.env.portal.rest + "/i18n/bundle/" + resourceBundleName + "-" + lang + ".json";
    console.log("url: " + url);
    */

    eXo.env.app.rest.resourcesBundle = eXo.env.portal.rest + "/i18n/bundle";
  </script>
</head>
<body>
<div id="outlook-pane">

  <div id="outlook-brand-bar" class="ms-bgColor-themePrimary ms-borderColor-themePrimary">
    <ul class="brandBar ms-font-m">
      <li class="brand">
        <a class="ms-Link ms-fontColor-yellow ms-fontColor-yellow--hover brandLink" href="/portal" target="_blank">
          <img src="/outlook/images/exo-icon-24.png"><span class="brandTitle">eXo Platform</span>
        </a>
      </li>
      <li class="showLogout">
        <a class="ms-Link ms-fontColor-yellow ms-fontColor-yellow--hover showLogoutLink" href="javascript:void(0);"
           target="_self" onclick="logout();">
          <img src="/outlook/images/16x16/logout-gray-yellow.png" class="showLogoutIcon"><span class="showLogoutTitle"
                                                                                               th:text="#{Outlook.logout}"/>
        </a>
      </li>
    </ul>
    <div class="ms-Dialog logoutDialog" style="display: none;">
      <div class="ms-Overlay ms-Overlay--dark js-DialogAction--close"></div>
      <div class="ms-Dialog-main">
        <button class="ms-Dialog-button ms-Dialog-button--close js-DialogAction--close">
          <i class="ms-Icon ms-Icon--x"></i>
        </button>
        <div class="ms-Dialog-header">
          <p class="ms-Dialog-title text-centered" th:text="#{Outlook.logoutTitle}"/>
        </div>
        <div class="ms-Dialog-inner">
          <form role="form">
            <div class="ms-Dialog-content">
              <p class="ms-Dialog-subText" th:text="#{Outlook.logoutQuestion}"/>
            </div>
            <div class="ms-Dialog-actions text-centered">
              <button class="ms-Dialog-action ms-Button ms-Button--primary logout">
                <span class="ms-Button-label" title="&{Outlook.logoutDescription}"
                      th:title="#{Outlook.cancelLogoutDescription}" th:text="#{Outlook.logout}"/>
              </button>
              <button class="ms-Dialog-action ms-Button cancel">
                <span class="ms-Button-label" th:title="#{Outlook.cancelLogoutDescription}"
                      th:text="#{Outlook.cancel}"/>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div id="outlook-popup" style="display: none;"></div>
</div>
</body>
</html>